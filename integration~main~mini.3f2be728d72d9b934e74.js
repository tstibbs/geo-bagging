(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{"/1C1":function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return c}));var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r=t[5],o=t[6],l=t[7],c=t[8];t[9],t[10];function d(t){return null==t||0===t.trim().lenght||","==t.trim()?null:t}var u=[["Notes",d(s)],["Design",d(l)],["Location",d(r)],["Position",d(o)]];this.addMarker(n,e,i,c,n,u,null,[a])}}),a=e("jCEb"),s=e.p+"bcdea73cee99779b48ef40c5b6dbc4e9.png",r=["Waymarks"],o={};o[r[0]]={AA_Signs:"AA Signs",Boundary_Markers:"Boundary Markers",Canal_Milemarkers:"Canal Milemarkers"};var l=s;function c(t){return{aspectLabel:"Waymarks",defaultIcon:new a.a(t,l,{iconUrl:l}),dimensionNames:r,dimensionValueLabels:o,dataToLoad:"data.json",parser:n,attribution:'&copy; <a href="http://www.msocrepository.co.uk/">The Milestone Society</a>'}}},"/OCx":function(t,i,e){"use strict";var n=e("4R65"),a=e.n(n);e("bMVF");delete a.a.Icon.Default.prototype._getIconUrl;let s=e("Y5fm").default,r=e("WE1v").default,o=e("4rkx").default;var l=null!=window.geoBaggingBaseUrl?window.geoBaggingBaseUrl:"";a.a.Icon.Default.mergeOptions({iconRetinaUrl:l+r,iconUrl:l+s,shadowUrl:l+o}),i.a=a.a},"0a2G":function(t,i,e){"use strict";var n=e("xG9w");i.a={notEmpty:function(t){return null!=t&&t.length>0},_buildValue:function(t){return Array.isArray(t)&&2==t.length?'<a href="'+t[1]+'">'+t[0]+"</a>":t},_escapeValue:function(t){return Array.isArray(t)?t.map(this._escapeValue.bind(this)):n.a.escape(t)},buildShortDescription:function(t){return Object.keys(t).map((function(i){return t[i]})).filter((function(t){return null!=t&&""!=t})).map((function(t){function i(t){return Array.isArray(t)&&2==t.length?t[0]:t}return Array.isArray(t)?t.map(i).join("/"):i(t)})).join(", ")},buildDescription:function(t){var i="";return t.forEach(function(t){var e=t[0],n=t[1];if(null!=n&&""!=n)if(i.length>0&&(i+="<br />"),i+='<span class="popup-entry-key">'+e+": </span>",Array.isArray(n))if(n.length>1){i+='<ul class="popup-entry-list">';for(var a=0;a<n.length;a++)i+="<li>"+this._buildValue(n[a])+"</li>";i+="</ul>"}else i+="<span>"+this._buildValue(n[0])+"</span>";else i+="<span>"+this._buildValue(n)+"</span>"}.bind(this)),i},buildPopup:function(t,i,e,a,s,r){var o=n.a.escape(i),l=n.a.escape(e),c=null;null!=s&&(c=s.map(function(t){var i=t[0],e=t[1];return[n.a.escape(i),this._escapeValue(e)]}.bind(this)));var d="<div>";if(this.notEmpty(l)?d='<a href="'+l+'" class="popup-title">'+o+"</a>":this.notEmpty(o)&&(d='<span class="popup-title">'+o+"</span>"),t.shouldManageVisits()&&null!=r&&(d+='<label class="fancy-checkbox" title="Visited?">',d+='    <input type="checkbox"'+(r?" checked":"")+"/>",d+='    <i class="fa fa-check"></i>',d+="</label>"),null!=c&&(d.length>0&&(d+="<br />"),d+=this.buildDescription(c)),null!=a){var u=a[0],h=a[1];d+='<div class="expandable expandable-links">',d+='<input type="checkbox" value="selected" id="links-checkbox" class="expandable-checkbox">',d+='<label for="links-checkbox" class="expandable-checkbox-label"><i class="fa fa-external-link" aria-hidden="true"></i></label>',d+='<div class="expandable-content links">',d+='<a href="'+("https://www.google.com/maps/place/"+u+"+"+h+"/@"+u+","+h+",15z")+'">View on google maps</a>',d+='<br /><a href="'+("https://www.bing.com/maps/?mkt=en-gb&v=2&cp="+u+"~"+h+"&lvl=14&sp=Point."+u+"_"+h+"_"+o)+'">View on bing maps</a>',d+='<br /><a href="'+("https://tools.wmflabs.org/geohack/geohack.php?pagename="+o+"&params="+u+"_N_"+h+"_E_region%3AGB_")+'">View on geohack</a>',d+="</div>",d+="</div>"}return d+="</div>"}}},"1MBw":function(t,i,e){"use strict";var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r=t[5],o=/TP0*(\d+)/,l=null;o.test(n)&&(l="http://trigpointing.uk/trig/"+o.exec(n)[1]);var c=[["Physical Type",s],["Condition",r]];this.addMarker(n,e,i,l,a,c,s,[s,r])},add:function(t,i,e,n,a,s){this.addMarker(null,t[1],t[0],i,e,n,a,[a,s])},addWithoutDimensions:function(t,i,e,n){this.addMarker(null,t[1],t[0],i,e,null,n,[null],n)}});i.a=n},"6UUt":function(t,i,e){"use strict";e.r(i);var n=e("Ts1V").a.extend({parse:function(t){return{name:t.properties.name,geojson:{type:"FeatureCollection",features:[t]}}}});i.default={aspectLabel:"National Parks",dimensionNames:["National Parks"],dataToLoad:"data.geojson",parser:n,attribution:'Office for National Statistics (<a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/">OGL</a>)'}},"Cc/U":function(t,i,e){"use strict";e.r(i);var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r=[["Type",s],["Built/Opened",t[5]]];this.addMarker(n,e,i,a,n,r,null,[s])}});i.default={aspectLabel:"Coastal Landmarks",dimensionNames:["Type"],dataToLoad:"data.json",parser:n,attribution:'Adapted from data from <a href="https://en.wikipedia.org">Wikipedia</a> licenced under <a href="https://creativecommons.org/licenses/by-sa/3.0/">CC&nbsp;BY&#8209;SA</a>'}},DIoK:function(t,i,e){"use strict";var n=e("EVdn"),a=e.n(n);i.a=function(t,i){if(a()("div.full-screen-link").length>0){var e=a()('<a href="#">Open in full screen</a>');e.click((function(){var e=i.getZoom(),n=i.getCenter(),a=t.baseUrl+"index.html?datasources=trigs&startPosition="+n.lat+","+n.lng+"&startZoom="+e;window.location.href=a})),a()("div.full-screen-link").append(e)}}},EH3g:function(t,i,e){"use strict";var n=e("XDP4"),a=e("/OCx").a.Class.extend({initialize:function(){this.update()},update:function(){this._params={};var t=n.a.location.search;t.length>0&&(t=t.substr(1)).split("&").forEach(function(t){var i=t.split("=");this._params[i[0]]=decodeURIComponent(i[1])}.bind(this))},getParams:function(){return this._params},test:function(t){return this._params[t]}}),s=new a;i.a={test:function(t){return s.test(t)},tester:a}},"F/eF":function(t,i,e){"use strict";e.r(i);var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r=t[5],o=t[6],l=t[7],c=t[8],d=t[9],u=t[10],h=t[11],f=[["Style",o],["Position",c],["Notes",u],["Purpose",s]];if(!o.includes(a)||null!=r){var p=a;null!=r&&(p+=" / "+r),f.push(["Type",p])}f.push(["Images",this.buildImageLinks(h)]),this.addMarker(n,e,i,l,n,f,null,[s,a,d])}});i.default={aspectLabel:"Defence of Britain",dimensionNames:["Purpose","Type","Condition"],dataToLoad:"data.json",parser:n,attribution:'"Defence of Britain" data &copy; <a href="https://doi.org/10.5284/1000327">Council for British Archaeology</a> 2006'}},FKx1:function(t,i,e){"use strict";var n=e("4R65"),a=e.n(n),s=e("EVdn"),r=e.n(s),o=e("XDP4"),l=e("EH3g"),c=e("kHqW"),d=o.a.location.pathname.split("/").pop(),u={baseUrl:null!=window.geoBaggingBaseUrl?window.geoBaggingBaseUrl:"",remoteData:!1,map_style:"full",cluster:!0,dimensional_layering:!1,initial_zoom:13,start_position:[53.374694,-1.711474],force_config_override:!1,map_element_id:"map",map_outer_container_element:r()("body"),page_id:d,show_zoom_control:!0,show_selection_control:!0,show_search_control:!0,show_locate_control:!0,show_layers_control:!0,show_position_control:!0,show_hider_control:"mobile",use_sidebar:!0,hider_control_start_visible:!0,icons:{},dimensionNames:[],dimensionValueLabels:{},defaultLayer:"OS",markerConstraints:null},h=a.a.Class.extend({initialize:function(t,i){var e=r.a.extend({},u,t);if(this._checkForUndefaultedProperties(t,"window config"),e.bundles=i,this._storageId="os_map:"+e.page_id+"config",null==t||!0!==t.force_config_override){var n=this._getSavedConfig();e=r.a.extend({},e,n)}for(var a in l.a.test("startPosition")&&(e.start_position=l.a.test("startPosition").split(",")),l.a.test("startZoom")&&(e.initial_zoom=l.a.test("startZoom")),this._buildMarkerConstraints(e),"true"==l.a.test("remoteData")&&(e.remoteData=!0),e)e.hasOwnProperty(a)&&(this[a]=e[a])},_buildMarkerConstraints:function(t){var i=null;if(null!=l.a.test("constraints")?i=l.a.test("constraints"):null!=t.markerConstraints&&"string"==typeof t.markerConstraints&&(i=t.markerConstraints),null!=i){var e=i.split(","),n=null,s=null,r=null,o=null;if(2==e.length){var d=c.a.gridRefToLngLat(e[0]);s=d[0],n=d[1];var u=c.a.gridRefToLngLat(e[1]);o=u[0],r=u[1]}else n=parseFloat(e[0]),s=parseFloat(e[1]),r=parseFloat(e[2]),o=parseFloat(e[3]);t.markerConstraints=[[r,s],[n,o]]}null!=t.markerConstraints&&Array.isArray(t.markerConstraints)&&(t.markerConstraints=a.a.latLngBounds(t.markerConstraints)),null!=t.markerConstraints&&"function"==typeof t.markerConstraints&&(t.markerConstraintsMatcher=t.markerConstraints),null!=t.markerConstraints&&null==t.markerConstraintsMatcher&&(t.markerConstraintsMatcher=function(i){return t.markerConstraints.contains(i.latLng)})},_checkForUndefaultedProperties:function(t,i){for(var e in t)t.hasOwnProperty(e)&&!u.hasOwnProperty(e)&&console.warn('Property "'+e+'" (set from '+i+") should have a default")},_getSavedConfig:function(){if(void 0!==localStorage){var t=localStorage.getItem(this._storageId);return null!=t?JSON.parse(t):null}return null},persist:function(t){if(void 0!==localStorage){var i=this._getSavedConfig();null!=i&&(t=r.a.extend({},i,t)),localStorage.setItem(this._storageId,JSON.stringify(t))}}});i.a=h},"ICp+":function(t,i,e){"use strict";var n=e("FKx1"),a=e("EH3g"),s=e("EVdn"),r=e.n(s),o=e("/OCx"),l=e("DIoK"),c=e("XDP4"),d=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i,u=/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i,h=a.a.test("mobile"),f=function(){if(h)return!0;var t=c.a.navigator.userAgent||c.a.navigator.vendor||c.a.opera;return d.test(t)||u.test(t.substr(0,4))},p=o.a.Class.extend({initialize:function(t){this._config=t,this._createView(),this._map=new o.a.Map(this._config.map_element_id,{zoomControl:!1}),this._map.setView(new o.a.LatLng(this._config.start_position[0],this._config.start_position[1]),this._config.initial_zoom),Object(l.a)(this._config,this._map),this._map.on("zoomend moveend dragend",(function(){this._saveLocation()}),this)},_createView:function(){var t="",i="";"mini"==this._config.map_style||"mini_embedded"==this._config.map_style?i=' class="mini-map"':"full"==this._config.map_style?i=' class="full-screen"':"embedded"==this._config.map_style&&(i=' class="embedded-map"'),"mini"!=this._config.map_style&&"mini_embedded"!=this._config.map_style||(t+='<div class="mini-map">'),t+='<div id="'+this._config.map_element_id+'"'+i+"></div>","mini"==this._config.map_style&&(t+="</div>",t+='<div class="full-screen-link"></div>'),"full"==this._config.map_style&&this._config.map_outer_container_element.addClass("full-screen"),f()&&this._config.map_outer_container_element.addClass("mobile"),this._config.map_outer_container_element.prepend(r()(t))},_saveLocation:function(){var t=this._map.getCenter(),i=[t.lat,t.lng],e=this._map.getZoom();if(void 0!==localStorage){var n={start_position:i,initial_zoom:e};this._config.persist(n)}},getMap:function(){return this._map}}),g=e("Wfk2"),m=e("xG9w"),_=e("4R65"),b=e.n(_),v=(e("OsGc"),e("gkNi"),e("JXP8")),w=e.n(v).a,y=e("2gd1"),k=e.n(y).a,C=e("0a2G"),L=function(t,i,e,n){var a=t.latLng,s=t.name,l=t.extraTexts,c=t.exportName,d=t.icon,u=t.url,h=t.visited;C.a.notEmpty(s)||(s=u),C.a.notEmpty(c)&&(c=s);var f=C.a.buildPopup(n,s,u,a,l,h),p={};null!=i.icons&&null!=i.icons[d]?p.icon=i.icons[d]:null!=i.defaultIcon&&(p.icon=i.defaultIcon),p.layerId=t.layerId;var _=o.a.marker(a,p),b=r()("<div>"+f+"</div>");n.shouldManageVisits()&&r()("input",b).change((function(){var i="";i=this.checked?"recordVisit":"removeVisit",r.a.post({url:g.a.backendBaseUrl+i,data:JSON.stringify({source:e,name:t.id}),contentType:"application/json",xhrFields:{withCredentials:!0}}).catch((function(t,i,e){401==t.status?console.log("Authentication required"):console.log("Request failed: "+t.status+", "+i+", "+e)}))})),_.bindPopup(b[0]),c=m.a.escape(t.exportName);var v=null,w=null;return null!=l&&(v=m.a.escape(C.a.buildShortDescription(l)),w=m.a.escape(C.a.buildDescription(l))),_.exportData={name:c,link:u,cmt:v,desc:w},_},x=b.a.Class.extend({initialize:function(t,i,e,n,a,s,r){this._map=t,this._config=i,this._modelsByAspect=e,this._matrixLayerControl=n,this._controls=a,this._bundles=s,this._parentGroup=null,this._manager=r},_translateMarkerGroup:function(t,i,e){if(null!=t)if(t.constructor===Array)t.forEach((function(t,n,a){a[n]=L(t,i,e,this._manager)}),this);else for(var n in t)t[n]=this._translateMarkerGroup(t[n],i,e);return t},finish:function(t){var i=r.a.Deferred();if(this._config.cluster){var e=r()("div#map"),n=Math.max(e[0].offsetHeight,e[0].offsetWidth)/10;this._parentGroup=new w.MarkerClusterGroup({disableClusteringAtZoom:15,maxClusterRadius:n,chunkedLoading:!0,chunkProgress:function(t,e,n,a){t===e&&i.resolve()}})}else this._parentGroup=b.a.layerGroup(),i.resolve();if(this._parentGroup.addTo(this._map),this._config.dimensional_layering)for(var a in this._modelsByAspect){var s=this._modelsByAspect[a];this.addClusteredModel(a,s)}else{var o=Object.keys(this._modelsByAspect).map(function(t){var i=this._modelsByAspect[t];return this._translateMarkerGroup(i.getMarkerList(),i.getBundleConfig(),t)}.bind(this)).filter((function(t){return null!=t})),l=[].concat.apply([],o);if(this._config.cluster){var c=l.reduce((function(t,i){var e=i.options.layerId;return null==t[e=null==e?"null":e]&&(t[e]=[]),t[e].push(i),t}),{});this._parentGroup.addLayers(c.null),Object.keys(c).filter((function(t){return"null"!==t})).forEach(function(t){for(var i=c[t],e=b.a.layerGroup(),n=0;n<i.length;n++)e.addLayer(i[n]);e.addTo(this._map)}.bind(this))}else for(var d=0;d<l.length;d++)this._parentGroup.addLayer(l[d])}return i.promise()},addClusteredModel:function(t,i){if(null!=i.getMarkerList()){var e=this._translateMarkerGroup(i.getMarkerList(),i.getBundleConfig(),t),n={};this.depthFirstIteration(e,"",n);var a=this._bundles[t];this._matrixLayerControl.addAspect(t,n,a)}},depthFirstIteration:function(t,i,e){if(t.constructor===Array){var n=new k(this._parentGroup,t);e[i]=n}else Object.keys(t).forEach(function(n){var a=0===i.length?n:i+"/"+n,s=t[n];this.depthFirstIteration(s,a,e)}.bind(this))}}),T=o.a.Class.extend({initialize:function(t,i,e,n,a){this._map=t,this._config=i,this._modelsByAspect=e,this._matrixLayerControl=n,this._bundles=a},finish:function(t){if(!this._config.dimensional_layering&&Object.keys(this._modelsByAspect).length>0)throw new Error("!dimensional_layering is not supported yet.");o.a.layerGroup(),Object.keys(this._modelsByAspect).forEach(function(t){var i=this._modelsByAspect[t];this.addClusteredModel(t,i)}.bind(this));return r.a.Deferred().resolve().promise()},addClusteredModel:function(t,i){var e=this._bundles[t],n=i.buildLayers();Object.values(n).forEach(function(t){t.addTo(this._map)}.bind(this)),this._matrixLayerControl.addAspect(t,n,e)}}),M=e("o4tf"),A=e("Ts1V"),V=e("Tmdr"),D=e.n(V),O=(e("b4G2"),D.a),j=o.a.Class.extend({initialize:function(){this._tester=new a.a.tester},sourceLoaded:function(t){this._tester.update();var i=this._tester.getParams(),e=i.datasources;e=null==e?"":e,delete i.datasources,e=e.length>0?e+","+t:t;var n=Object.keys(i).map((function(t){return t+"="+i[t]})).join("&");n=(n.length>0?n+"&":"")+"datasources="+e;document.location.origin,document.location.pathname}}),I=o.a.Class.extend({initialize:function(t,i){this._bundles=t,this._manager=i,this._controls=i.getControls(),this._matrixLayerControl=null,this._urlHandler=new j},_filterModels:function(t,i){var e={};return Object.keys(t).filter((function(e){return t[e]instanceof i})).forEach((function(i){e[i]=t[i]})),e},_addLazyModels:function(t,i){Object.keys(t).forEach(function(e){var n=t[e],a=function(){n.fetchData().done(function(){i(e,n),this._addAttribution(e,n),this._urlHandler.sourceLoaded(e)}.bind(this))}.bind(this),s=n.getMeta(),r=s.recordCount+" items (last updated "+s.lastUpdated+")",o=this._bundles[e];this._matrixLayerControl.addLazyAspect(e,o,{description:r,callback:a})}.bind(this))},_addAttribution:function(t,i){var e=i.getAttribution();if(null!=e&&e.length>0){var n=i.getBundleConfig().aspectLabel;this._controls.addAttribution(n,e)}},loadModelViews:function(t,i,e,n){var a=this._filterModels(t,M.a),s=this._filterModels(t,A.a),o=this._filterModels(i,M.a),l=this._filterModels(i,A.a);e.dimensional_layering&&(this._matrixLayerControl=new O(this._manager.getLayers(),null,{},{multiAspects:!0,embeddable:e.use_sidebar}));var c=new x(this._manager.getMap(),e,a,this._matrixLayerControl,this._controls,this._bundles,this._manager),d=new T(this._manager.getMap(),e,s,this._matrixLayerControl,this._bundles),u=[c.finish(),d.finish()];e.dimensional_layering&&(this._addLazyModels(o,(function(t,i){c.addClusteredModel(t,i)})),this._addLazyModels(l,(function(t,i){d.addClusteredModel(t,i)}))),r.a.when.apply(r.a,u).always(function(){e.dimensional_layering&&this._controls.addControl(this._matrixLayerControl),Object.keys(t).forEach(function(i){var e=t[i];this._addAttribution(i,e)}.bind(this)),n()}.bind(this))}});const E={};var S;(S=e("jKyv")).keys().forEach(t=>{E[t]=S(t).default});var P=o.a.Class.extend({initialize:function(t,i){this._manager=t,this._config=i},loadSources:function(t){var i=a.a.test("extra-datasources"),e=null!=i&&i.length>0?i.split(","):[],n=r.a.uniqueSort(t.concat(g.a.dataSources,e)),s=this._sourceIdsToDataSources(n),o=r.a.Deferred(),l={};s.forEach(function(t){var i=E["./"+t+".js"];"function"==typeof i&&(i=i(this._config)),l[t]=i}.bind(this));var c=this._config.remoteData?"https://cdn.jsdelivr.net/gh/tstibbs/geo-bagging@gh-pages":this._config.baseUrl,d={},u={},h=Object.keys(l).map(function(i){var e=l[i],n=new e.parser(this._manager,e,i,c),a=n.fetchMeta();if(-1!=t.indexOf(i)){var s=n.fetchData();return d[i]=n,r.a.when(a,s)}return u[i]=n,a}.bind(this));return r.a.when.apply(r.a,h).always(function(){new I(l,this._manager).loadModelViews(d,u,this._config,this._finish),o.resolve()}.bind(this)),setTimeout(()=>{this._finish(),o.resolve()},1),o.promise()},_sourceIdsToDataSources:function(t){return t=null!=t?t.map((function(t){return-1==t.indexOf("/")?t+"/config":t})):[]},_finish:function(){r()("div#loading-message-pane").hide()}}),N=e("v1l7"),U=(e("5fbX"),N.a),B=e("fPJb"),F=e.n(B),z=e("aeW8"),H=e.n(z),G=(e("BSSW"),F.a.extend({options:{actions:{gpx:{display:"Export to GPX file",action:H()((function(){var t=new Date;return"geoPoints_"+(t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+"_"+t.getHours()+"-"+t.getMinutes()+"-"+t.getSeconds())+".gpx"}))}}}})),R=e("DeUa"),W=e.n(R),Z=(e("HYQ+"),W.a.extend({options:{keepCurrentZoomLevel:!0,setView:"once"}})),K=e("ftvv"),q=e("V44I"),J=(e("UEl+"),e("ONFo")),X=(e("bhAg"),J.a),Q=e("kHqW"),Y=X.extend({options:{formatter:function(t,i){return Q.a.latLngToGridRef(i,t)}}}),$=e("L7i5"),tt=(e("Has+"),$.a),it=tt.extend({options:{onMove:!0,icon:!0,latLngFormatter:function(t,i){return Q.a.latLngToGridRef(t,i)}},addTo:function(t){tt.prototype.addTo.call(this,t),this._addShowHideHandling()},_addShowHideHandling:function(){var t=r()("div.leaflet-control-mapcentercoord-icon.leaflet-zoom-hide"),i=!1;function e(){t.css("visibility","hidden"),i=!1}r()("div.leaflet-control-mapcentercoord.leaflet-control").click((function(){i?e():(t.css("visibility","visible"),i=!0)})),e()}}),et=e("Vjqd"),nt=(e("PMnc"),et.a),at=o.a.Class.extend({initialize:function(t){this._container=t;let i=r()('<div class="attribution-entry"></div>\n\t<span class="attribution-source">Geo-bagging</span>\n\t<span>\n\t\tThe code on this site is copyright \n\t\t<a href="https://github.com/tstibbs">tstibbs</a>/stripycoder, \n\t\tlicenced under AGPL, \n\t\tsource code available at \n\t\t<a href="https://github.com/tstibbs/geo-bagging">here</a>.\n\t</span>\n\t<br />\n\t<span>\n\t\tMany open source libraries help make this project, see a full list in <a href="licenses.txt">licenses.txt</a>.\n\t</span>\n</div>');this._container.append(i)},addAttribution:function(t,i){let e=r()(`<div class="attribution-entry">\n\t<span class="attribution-source">${t} data</span>\n\t<span>${i}</span>\n</div>`);this._container.append(e)}}),st=o.a.Class.extend({initialize:function(t){this._view=r()('<div class="setting"></div>'),t.isAuthenticated()?this._view.append(r()("<span>Logged in as "+t.getLoggedInUser()+"</span>")):this._view.append(r()('<a href="'+g.a.backendBaseUrl+'login">Click here to log in</a>'))},getView:function(){return this._view}}),rt=e("Qv4j"),ot=o.a.Class.extend({initialize:function(t){this._manager=t,this._buildView(),this._buildControl()},_buildView:function(){var t="",i="true"==a.a.test("testing");t+='<div id="sidebar" class="'+["sidebar","collapsed","leaflet-container"].join(" ")+'">',t+='    <div class="sidebar-tabs">',t+='        <ul role="tablist">',t+='            <li><a href="#sidebar-layers" role="tab"><i class="fa fa-bars"></i></a></li>',t+='            <li><a href="#sidebar-constraints" role="tab"><i class="fa fa-map-o"></i></a></li>',t+="        </ul>",t+='        <ul role="tablist">',i&&(t+='            <li><a href="#sidebar-user" role="tab"><i class="fa fa-user"></i></a></li>'),t+='            <li><a href="#sidebar-attribution" role="tab"><i class="fa fa-copyright"></i></a></li>',t+="        </ul>",t+="    </div>",t+='    <div class="sidebar-content">',t+='        <div id="sidebar-layers" class="sidebar-pane">',t+='            <h1 class="sidebar-header">Layers<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>',t+="        </div>",t+='        <div id="sidebar-constraints" class="sidebar-pane">',t+='            <h1 class="sidebar-header">Data Limits<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>',t+="        </div>",t+='        <div id="sidebar-attribution" class="sidebar-pane">',t+='            <h1 class="sidebar-header">Attribution<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>',t+="        </div>",i&&(t+='        <div id="sidebar-user" class="sidebar-pane">',t+='            <h1 class="sidebar-header">User Settings<span class="sidebar-close"><i class="fa fa-caret-left"></i></span></h1>',t+="        </div>"),t+="    </div>",t+="</div>",this._view=r()(t),this._manager.getConfig().map_outer_container_element.append(this._view);var e=r()("<div></div>");if(r()("#sidebar-attribution",this._view).append(e),this._attributionView=new at(e),i){var n=new st(this._manager);r()("#sidebar-user",this._view).append(n.getView())}var s=new rt.a(this._manager);r()("#sidebar-constraints",this._view).append(s.getView())},_buildControl:function(){this._control=new nt("sidebar")},addTo:function(t){this._control.addTo(t)},getContainer:function(){return this._view[0]},addLayers:function(t){r()("#sidebar-layers",this._view).append(t.getContainer())},addAttribution:function(t,i){this._attributionView.addAttribution(t,i)}}),lt=[U,ot,o.a.Control.Zoom,Z,K.a,o.a.Control.Layers,G,Y,it,o.a.Control.Attribution],ct=o.a.Class.extend({initialize:function(t,i,e,n){this._controlsToHide=[],this._controlsToAdd=[],this._config=t,this._layers=i,this._manager=n,this._addDefaults(),null!=e&&this._addAllTo(e)},_addDefaults:function(){var t={};this._config.use_sidebar&&(this._menuView=new ot(this._manager),this.addControl(this._menuView),t={position:"topright"}),this._config.show_zoom_control&&this.addControl(new o.a.Control.Zoom(t)),this._config.show_selection_control&&this.addControl(new G),this._config.show_search_control&&this.addControl(new K.a(r.a.extend({showPopup:!0,provider:new q.a({key:g.a.bingKey})},t))),(!0===this._config.show_hider_control||"mobile"==this._config.show_hider_control&&f())&&this.addControl(new U(this._controlsToHide,{visibleByDefault:this._config.hider_control_start_visible})),this._config.show_locate_control&&this.addControl(new Z(t)),this._config.show_layers_control&&null!=this._layers&&Object.keys(this._layers).length>1&&this.addControl(new o.a.Control.Layers(this._layers,null)),this._config.show_position_control&&(f()?this.addControl(new it):this.addControl(new Y))},addControl:function(t){for(var i=null,e=!1,n=0;n<lt.length;n++)if(t instanceof lt[n]){null!=this._controlsToAdd[n]&&(console&&console.debug('Overwriting existing control "'+this._controlsToAdd[n]+'" with "'+t+'".'),i=this._controlsToAdd[n]),this._controlsToAdd[n]=t,t instanceof U||this._controlsToHide.push(t),e=!0;break}if(e||(console.error("Unrecognised control: "+t),this._controlsToHide.push(t),this._controlsToAdd[Math.max(lt.length,this._controlsToAdd.length)]=t),null!=this._map&&(t.addTo(this._map),null!=i))if(t instanceof O&&i instanceof o.a.Control.Layers&&this._config.use_sidebar)i.remove(),this._menuView.addLayers(t);else{var a=t._container,s=i._container;r()(a).remove(),r()(s).replaceWith(a),i.remove()}},_addAllTo:function(t){this._controlsToAdd.forEach(function(i){null!=i&&i.addTo(t)}.bind(this)),this._map=t},addAttribution:function(t,i){this._config.use_sidebar&&this._menuView.addAttribution(t,i)}}),dt=e("5XD8").a,ut={key:g.a.bingKey},ht=o.a.extend({maxZoom:18,minZoom:0,detectRetina:!0},ut),ft=new dt(o.a.extend({imagerySet:"OrdnanceSurvey",minZoom:12,maxZoom:18,maxNativeZoom:17},ut)),pt=new dt(o.a.extend({imagerySet:"RoadOnDemand",maxZoom:11,minZoom:0},ut)),gt=o.a.layerGroup([ft,pt]),mt=new dt(o.a.extend({imagerySet:"RoadOnDemand"},ht)),_t=new dt(o.a.extend({imagerySet:"AerialWithLabelsOnDemand"},ht)),bt=new dt(o.a.extend({imagerySet:"Aerial"},ht)),vt=new o.a.TileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:0,maxZoom:19,attribution:'Map data © <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'}),wt={OS:gt,"Bing Roads":mt,"Bing Satellite":bt,"Bing Hybrid":_t,OSM:vt};function yt(t,i,e){i.on("add",function(){e.persist({defaultLayer:t})}.bind(this))}var kt=function(t,i){var e=wt[i.defaultLayer];for(var n in null!=e?e.addTo(t):gt.addTo(t),wt)yt(n,wt[n],i);return wt},Ct=o.a.Class.extend({initialize:function(t,i){this._authenticated=!1;var e="true"==a.a.test("testing");this._initializePromise=e?r.a.Deferred(function(t){r.a.get({url:g.a.backendBaseUrl+"isAuthenticated",xhrFields:{withCredentials:!0}}).then(function(i){0==i?this._authenticated=!1:(this._authenticated=!0,this._loggedInUser=i.email),t.resolve()}.bind(this)).fail(function(i,e,n){401!=i.status&&(console.error("Failed to check authentication status - this can be ignored unless trying to record visits: "+e),console.log(n)),this._authenticated=!1,t.resolve()}.bind(this))}.bind(this)).promise():r.a.Deferred().resolve(),this._initializePromise=this._initializePromise.always(function(){this._map=t,this._config=i,this._layers=kt(t,i),this._controls=new ct(i,this._layers,t,this)}.bind(this))},waitForInitialization:function(){return this._initializePromise},setViewConstraints:function(t){this._limitFunction=t},getViewConstraints:function(){return this._limitFunction},getControls:function(){return this._controls},getMap:function(){return this._map},getLayers:function(){return this._layers},getConfig:function(){return this._config},setAuthenticated:function(t){this._authenticated=t},isAuthenticated:function(){return this._authenticated},shouldManageVisits:function(){return this.isAuthenticated()},getLoggedInUser:function(){return this._loggedInUser}});i.a={getBundleIds:function(t){var i=[];null!=t&&i.push.apply(i,t);var e=a.a.test("datasources");return null!=e&&e.length>0&&i.push.apply(i,e.split(",")),"true"==a.a.test("hills")&&i.push("hills"),"true"==a.a.test("trigs")&&i.push("trigs"),i},loadMap:function(t,i){null==t&&(t={});var e=this.getBundleIds(i);if(this.hasUrlData())throw alert("Loading data from URL is no longer an option."),new Error("Loading data from URL is no longer an option.");if(null!=t.pointsToLoad){var n=t.pointsToLoad.generalPoints;t.cluster=n.length>300,t.dimensional_layering=!1,e=["trigs/config_embedding"]}t=r.a.extend({cluster:!0,dimensional_layering:!0},t);var a=this._buildMap(t),s=new Ct(a.getMap(),this._config);return s.waitForInitialization().then(function(){return new P(s,this._config).loadSources(e)}.bind(this)).then((function(){return s}))},loadMiniMap:function(){this.loadMap({cluster:!1,dimensional_layering:!1,initial_zoom:10,start_position:[54.454463,-3.213515],show_search_control:!1,show_locate_control:!1,show_hider_control:!0,hider_control_start_visible:!1,map_style:"mini",use_sidebar:!1},["trigs/config_mini"])},_buildMap:function(t){return this._config=new n.a(t),new p(this._config)},hasUrlData:function(){return null!=a.a.test("trigs")}}},IbCe:function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return d}));var n=e("EVdn"),a=e.n(n),s=e("kHqW"),r=e("jCEb"),o=e("jvQH"),l=e("1MBw"),c=e("nEK/");function d(t){return a.a.extend(!0,{},Object(o.default)(t),{icons:{searchResult:new r.a(t,c.a,{iconUrl:c.a})},parser:l.a.extend({initialize:function(t,i,e,n){l.a.prototype.initialize.call(this,t,i,e,n);for(var a=this._config.pointsToLoad.generalPoints,r=0;r<a.length;r++){var o=a[r],c=s.a.osgbToLngLat(o.eastings,o.northings);this.addWithoutDimensions(c,o.url,o.name)}var d=this._config.pointsToLoad.significantPoint;if(null!=d){c=s.a.osgbToLngLat(d.eastings,d.northings);this.addWithoutDimensions(c,d.url,d.name,"searchResult")}},fetchData:function(){return a.a.Deferred().resolve().promise()},fetchMeta:function(){return a.a.Deferred().resolve().promise()}})})}},J9yo:function(t,i,e){},LEIh:function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return h}));e("/OCx");var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r="http://www.hill-bagging.co.uk/mountaindetails.php?rf="+n,o=[["Height",t[5]],["Classifications",this.split(s,this._bundleConfig.hillDisplayNames)]];this.addMarker(n,e,i,r,a,o,null,[s])}}),a=e("jCEb"),s=e("nEK/"),r=["Hills"],o={},l={};o[r[0]]=l;var c={5:"Dewey","5D":"Donald Dewey","5H":"Highland Five",C:"Corbett",CouT:"County Top",D:"Donald",G:"Graham",Hew:"Hewitt",Hu:"Hump",M:"Munro",MT:"Munro Top",Ma:"Marilyn",N:"Nutall",SIB:"Island (SIB)",Sim:"Simm",TU:"Tump",W:"Wainwright"},d={5:"Deweys","5D":"HighlandFives","5H":"HighlandFives",C:"Corbetts",CouT:"CountyTops",D:"Donalds",G:"Grahams",Hew:"Hewitts",Hu:"HuMPs",M:"Munros",MT:"Munros",Ma:"Marilyns",N:"Nuttalls",SIB:"SIBs",Sim:"Simms",TU:"Tumps",W:"Wainwrights"};Object.keys(c).forEach((function(t){l[t]='<a href="http://www.hill-bagging.co.uk/'+d[t]+'.php">'+c[t]+"</a>"}));var u=s.a;function h(t){return{aspectLabel:"Hills",defaultIcon:new a.a(t,u,{iconUrl:u}),dimensionNames:r,dimensionValueLabels:o,hillDisplayNames:c,dataToLoad:"data.json",parser:n,attribution:'&copy; <a href="http://www.hills-database.co.uk/downloads.html">The Database of British and Irish Hills</a>'}}},MSv7:function(t,i,e){"use strict";var n=e("/OCx"),a=e("EVdn"),s=e.n(a),r=n.a.Class.extend({initialize:function(t,i){this._manager=t,this._constraintsView=i,this._view=s()('<div class="setting"></div>'),this._currentAreaLimit=s()('<input type="checkbox">');var e=s()("<label>Limit new markers to current area</label>");e.prepend(this._currentAreaLimit),this._currentAreaLimit.change(function(t){t.target.checked?this._constraintsView.limitTo(this,this._manager.getMap().getBounds()):this._constraintsView.unlimit()}.bind(this)),this._view.append(e)},getView:function(){return this._view},reset:function(){this._currentAreaLimit.prop("checked",!1)}});i.a=r},"N1D+":function(t,i,e){"use strict";e.r(i);var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r=t[5],o=t[6],l=this._bundleConfig.dimensionValueLabels[this._bundleConfig.dimensionNames[0]],c=this._bundleConfig.dimensionValueLabels[this._bundleConfig.dimensionNames[1]],d=[["Type",this.split(r,l)],["Facilities",this.split(o,c)]];this.addMarker(n,e,i,s,a,d,null,[r,o])}}),a=["Type","Facilities"],s={};s[a[0]]={"houses-and-buildings":"Houses","gardens-and-parks":"Gardens & parks",countryside:"Countryside","coast-and-beaches":"Coast & beaches","castles-and-forts":"Castles & forts","sites-and-monuments":"Sites & monuments","churches-and-chapels":"Churches & chapels","mills-and-mines":"Mills, forges & mines","villages-and-pubs":"Villages & pubs"},s[a[1]]={"family-friendly":"Family-friendly","dog-friendly":"Dog-friendly","disabled-access":"Disabled access","for-hard-of-hearing":"For deaf/hard of hearing","for-visually-impaired":"For blind/visually impaired","places-to-eat-and-drink":"Places to eat & drink","ideal-for-group-visits":"Ideal for group visits","available-for-weddings":"Available for weddings","fifty-things":"50 things to do before you're 11 ¾"};i.default={aspectLabel:"National Trust",dimensionNames:a,dimensionValueLabels:s,dataToLoad:"data.json",parser:n,attribution:"&copy; National Trust"}},Nizc:function(t,i,e){"use strict";e.r(i);var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r=t[5],o=this._bundleConfig.typeData,l=this._bundleConfig.dimensionValueLabels[this._bundleConfig.dimensionNames[1]],c=[["Types",this.split(s,o)],["Launch Methods",this.split(r,l)]];this.addMarker(n,e,i,a,n,c,null,[s,r])}}),a=["Lifeboat Types","Launch Methods"],s={Atlantic85:["Atlantic 85","b-class-lifeboat"],Atlantic75:["Atlantic 75","b-class-lifeboat"],D:["D class","d-class-lifeboat"],H:["H class","rescue-hovercraft"],E:["E class","e-class-lifeboat"],Mersey:["Mersey","mersey-class-lifeboat"],Tyne:["Tyne","tyne-class-lifeboat"],Trent:["Trent","trent-class-lifeboat"],Tamar:["Tamar","tamar-class-lifeboat"],Severn:["Severn","severn-class-lifeboat"],Shannon:["Shannon","shannon-class-lifeboat"]};Object.keys(s).forEach((function(t){var i=s[t];s[t]=[i[0],"https://rnli.org/what-we-do/lifeboats-and-stations/our-lifeboat-fleet/"+i[1]]}));var r={};Object.keys(s).forEach((function(t){var i=s[t];r[t]='<a href="'+i[1]+'">'+i[0]+"</a>"}));var o={};o[a[0]]=r,o[a[1]]={MooredAfloat:"Moored Afloat",FloatingHouse:"Floating House",FloatingCradle:"Floating Cradle"};i.default={aspectLabel:"RNLI",dimensionNames:a,dimensionValueLabels:o,dataToLoad:"data.json",parser:n,attribution:'Contains <a href="https://hub.arcgis.com/datasets/7dad2e58254345c08dfde737ec348166_0">Open Data</a> licensed under the GIS Open Data Licence &copy; RNLI and data from <a href="https://en.wikipedia.org/wiki/List_of_RNLI_stations">Wikipedia</a>',typeData:s}},Qv4j:function(t,i,e){"use strict";(function(t){var n=e("EVdn"),a=e.n(n),s=e("/OCx"),r=e("WBhu"),o=e("eyOs"),l=e("MSv7"),c=s.a.Class.extend({initialize:function(t){this._manager=t,this._limitOriginView=null,this._view=a()("<div></div>");var i=a()('<div class="info">This section allows you to limit how much data is displayed on screen. This can be useful for example when on older or mobile devices which may struggle to remain responsive if a large amount of data is loaded.</div>');this._view.append(i),this._view.append('<hr class="info">');var e=new l.a(t,this);this._view.append(e.getView());var n=new o.a(t,this);this._view.append(n.getView()),this._fileConstraintsLoadView=new r.a(t,this),this._view.append(this._fileConstraintsLoadView.getView());var s=this._buildReset();this._view.append(s)},_buildReset:function(){var t=a()('<div class="setting"></div>'),i=a()('<button type="button">Reset</button>');return i.click(this.unlimit.bind(this)),t.append(i),t},limitTo:function(i,e){this.unlimit(),this._limitOriginView=i,this._manager.setViewConstraints(this._buildLimitFunction(e)),null!=this._constraintPolygon&&this._constraintPolygon.remove();var n=[[[-90,-180],[90,-180],[90,180],[-90,180]]];Array.isArray(e)||(e=[e]),e.forEach((function(t){n.push([t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()])})),this._constraintPolygon=new t.Polygon(n,{color:"rgb(0, 0, 0, 0)",fillColor:"rgb(90, 90, 90)",fillOpacity:.3}),this._constraintPolygon.addTo(this._manager.getMap())},_buildLimitFunction:function(t){return Array.isArray(t)?function(i){for(var e=0;e<t.length;e++)if(t[e].contains(i))return!0;return!1}:function(i){return t.contains(i)}},unlimit:function(){null!=this._limitOriginView&&(this._limitOriginView.reset(),this._limitOriginView=null),this._manager.setViewConstraints(null),null!=this._constraintPolygon&&this._constraintPolygon.remove()},getView:function(){return this._view}});i.a=c}).call(this,e("4R65"))},Ts1V:function(t,i,e){"use strict";var n=e("/OCx"),a=e("WvvZ"),s=e("0a2G"),r=a.a.extend({initialize:function(t,i,e,n){a.a.prototype.initialize.call(this,t,i,e,n),this._data=null,this._bundleConfig=i},fetchData:function(t){return this._doFetchData(t).done(function(t){this._data=t}.bind(this))},_parseDatas:function(){return this._data.features.map(function(t){return this.parse(t)}.bind(this))},_translateDatas:function(t){var i={};return t.forEach(function(t){var e=t.name,a=t.url,r=t.geojson,o=t.extraInfos,l=n.a.geoJSON(r,{onEachFeature:function(t,i){var n=s.a.buildPopup(this._manager,e,a,null,o,null);i.bindPopup(n)}.bind(this)});i[e]=l}.bind(this)),i},buildLayers:function(){var t=this._parseDatas();return this._translateDatas(t)},getAttribution:function(){return this._bundleConfig.attribution}});i.a=r},WBhu:function(t,i,e){"use strict";var n=e("/OCx"),a=e("EVdn"),s=e.n(a),r=e("6U+l"),o=n.a.Class.extend({initialize:function(t){this._manager=t,this._colour="#FF0000",this._layers=[]},showTracks:function(t){this._layers.forEach((function(t){t.remove()})),this._layers=t.map(function(t){let i=n.a.geoJSON(t,{color:this._colour,onEachFeature:function(t,i){t.properties&&t.properties.name&&i.bindPopup(t.properties.name)}});return i.addTo(this._manager.getMap()),i}.bind(this))}}),l=n.a.Class.extend({initialize:function(t,i){this._constraintsView=i,this._tracksView=new o(t),this._view=s()('<div class="setting"></div>'),this._view.append(s()("<span>Upload GPX tracks to see markers around those tracks:</span>")),this._fileInput=s()('<input type="file" multiple>'),this._view.append(this._fileInput),this._fileInput.on("change",this._readFiles.bind(this))},_readFiles:function(){for(var t=[],i=this._fileInput[0].files,e=0;e<i.length;e++)(function(e){var n=new FileReader;n.onload=function(e){var a=this._loadTrack(n.result);t.push(a),t.length==i.length&&this._finishedReadingFiles(t)}.bind(this),n.readAsText(e)}).bind(this)(i.item(e))},_finishedReadingFiles:function(t){var i=t.map((function(t){return t.bounds})),e=t.map((function(t){return t.features}));this._constraintsView.limitTo(this,i),this._tracksView.showTracks(e)},_loadTrack:function(t){var i=(new DOMParser).parseFromString(t,"text/xml"),e=Object(r.gpx)(i);return{features:e,bounds:this._geoJsonBounds(e)}},_geoJsonBounds:function(t){var i,e,a,s;t.features.forEach((function(t){var n=t.geometry,r=function(t){t.forEach((function(t){var n=t[0],r=t[1];(null==i||n<i)&&(i=n),(null==e||n>e)&&(e=n),(null==a||r<a)&&(a=r),(null==s||r>s)&&(s=r)}))};"MultiLineString"==n.type?n.coordinates.forEach(r):r(n.coordinates)}));var r=[a-.005,i-.01],o=[s+.005,e+.01];return n.a.latLngBounds(r,o)},getView:function(){return this._view},reset:function(){this._fileInput.val(""),this._tracksView.showTracks([])}});i.a=l},Wfk2:function(t,i,e){"use strict";i.a={bingKey:"AgYJwt3nv3bZyK31EDXorMaO8aIix-5kAa32O5TTwFAhdVYtZdIKhw3ttntsmgqy",dataSources:["follies","hills","milestones","defence","trails","rnli","nationalparks","coastallandmarks"],backendBaseUrl:"https://hu01wcuudf.execute-api.eu-west-2.amazonaws.com/default/"}},WvvZ:function(t,i,e){"use strict";var n=e("/OCx"),a=e("EVdn"),s=e.n(a),r=e("Wfk2"),o=n.a.Class.extend({initialize:function(t,i,e,n){this._markerList=null,this._manager=t,this._config=t.getConfig(),this._bundleConfig=i,this._bundleName=-1==e.indexOf("/")?e:e.substring(0,e.lastIndexOf("/")),this._urlPrefix=null!=n?n:"",this._visits=[]},_buildDataUrl:function(){return this._urlPrefix+"bundles/"+this._bundleName+"/"+this._bundleConfig.dataToLoad},_doFetchData:function(){var t=this._buildDataUrl(),i=s.a.ajax({url:t,dataType:"json"}).fail((function(t,i,e){console.error("Failed to load map data: "+i),console.log(e)}));if(this._manager.shouldManageVisits()){var e=s.a.get({url:r.a.backendBaseUrl+"listVisits?source="+this._bundleName,dataType:"json",xhrFields:{withCredentials:!0}}).then(function(t){this._visits=t.map(function(t){return t.substring(t.indexOf("-",t.indexOf("-")+1)+1)}.bind(this))}.bind(this)).fail((function(t,i,e){console.error("Failed to load map data: "+i),console.log(e)}));return s.a.when(i,e).then((function(t){return t[0]}))}return i},fetchMeta:function(){var t=this._buildDataUrl()+".meta";return s.a.ajax({url:t,dataType:"json"}).fail((function(t,i,e){console.error("Failed to load source metadata: "+i),console.log(e)})).done(function(t){this._meta=t}.bind(this))},getMeta:function(){return this._meta},getVisits:function(){return this._visits},getBundleConfig:function(){return this._bundleConfig}});i.a=o},XDP4:function(t,i,e){"use strict";i.a=window},ZhdR:function(t,i,e){"use strict";e.r(i);e("/OCx");var n=e("o4tf").a.extend({parse:function(t){var i=t[0],e=t[1],n=t[2],a=t[3],s=t[4],r=t[5],o=this._bundleConfig.dimensionValueLabels[this._bundleConfig.dimensionNames[0]][s];null==o&&(o=s);var l=[["Type",o],["Images",this.buildImageLinks(r)]];this.addMarker(n,e,i,a,n,l,null,[s])}}),a=["Follies"],s={};s[a[0]]={Arch_Gateway:"Arch/Gateway"};i.default={aspectLabel:"Follies",dimensionNames:a,dimensionValueLabels:s,dataToLoad:"data.json",parser:n,attribution:'Reproduced with the kind permission of Paul from <a href="http://www.follies.org.uk/follymaps.htm">The Folly Fellowship</a>'}},eyOs:function(t,i,e){"use strict";var n=e("/OCx"),a=e("EVdn"),s=e.n(a),r=n.a.Class.extend({initialize:function(t,i){this._manager=t,this._constraintsView=i,this._view=s()('<div class="setting"></div>');var e=s()('<button type="button">Limit to 5 miles from current location</button>');e.click(this._limitToCurrentLocation.bind(this)),this._view.append(e)},_limitToCurrentLocation:function(){var t=this._manager.getMap(),i=function(e){t.off("locationfound",i);var a=e.latlng.lat,s=e.latlng.lng,r=new n.a.latLngBounds([a+.08,s+.12],[a-.08,s-.12]);this._constraintsView.limitTo(this,r)}.bind(this);t.on("locationfound",i),t.stopLocate(),t.locate()},getView:function(){return this._view},reset:function(){}});i.a=r},jCEb:function(t,i,e){"use strict";var n=e("4R65"),a=e.n(n),s=a.a.Icon.Default.extend({initialize:function(t,i,e){i=t.baseUrl+i,this._customIconPath=i,null!=e.iconUrl&&(e.iconUrl=t.baseUrl+e.iconUrl,null==e.iconRetinaUrl&&(e.iconRetinaUrl=e.iconUrl)),null!=e.iconRetinaUrl&&(e.iconRetinaUrl=t.baseUrl+e.iconRetinaUrl),a.a.Icon.Default.prototype.initialize.call(this,e)},_getIconUrl:function(t){var i=a.a.Icon.prototype._getIconUrl.call(this,t);return i==this._customIconPath?i:a.a.Icon.Default.prototype._getIconUrl.call(this,t)}});i.a=s},jKyv:function(t,i,e){var n={"./coastallandmarks/config.js":"Cc/U","./defence/config.js":"F/eF","./follies/config.js":"ZhdR","./hills/config.js":"LEIh","./hills/config_all.js":"ttLr","./milestones/config.js":"/1C1","./nationalparks/config.js":"6UUt","./nt/config.js":"N1D+","./rnli/config.js":"Nizc","./trails/config.js":"tVao","./trigs/config.js":"mifp","./trigs/config_base.js":"jvQH","./trigs/config_embedding.js":"IbCe","./trigs/config_mini.js":"r6U7"};function a(t){var i=s(t);return e(i)}function s(t){if(!e.o(n,t)){var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}return n[t]}a.keys=function(){return Object.keys(n)},a.resolve=s,t.exports=a,a.id="jKyv"},jvQH:function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return c}));e("/OCx");var n=e("1MBw"),a=e("jCEb"),s=e.p+"d6a3c2969cb19fe70846152c8cb86b6a.png",r=["Type","Condition"],o={},l={};function c(t){return{aspectLabel:"Trig Points",icons:{Pillar:new a.a(t,s,{iconUrl:s,iconAnchor:[10,40],popupAnchor:[1,-38]})},dimensionNames:r,dimensionValueLabels:o,parser:n.a,attribution:'&copy; <a href="http://trigpointing.uk">trigpointing.uk</a> and licenced by Ordnance Survey under the <a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3/">Open Government Licence</a>.'}}o[r[0]]=l,["Pillar","Bolt","Surface Block","Rivet","Buried Block","Cut","Other","Berntsen","FBM","Intersected Station","Disc","Brass Plate","Active station","Block","Concrete Ring","Curry Stool","Fenomark","Platform Bolt","Cannon","Spider","Pipe"].forEach((function(t){l[t]='<a href="http://trigpointing.uk/wiki/'+t+'">'+t+"</a>"}))},kHqW:function(t,i,e){"use strict";var n=e("p5/s"),a=Object(n.a)("+proj=tmerc +lat_0=49 +lon_0=-2 +k=0.9996012717 +x_0=400000 +y_0=-100000 +ellps=airy +datum=OSGB36 +units=m +no_defs");function s(t,i){for(var e=t.toString();e.length<i;)e="0"+e;return e}i.a={latLngToGridRef:function(t,i){var e=10,n=a.forward([i,t]),r=n[0],o=n[1];if(e=void 0===e?10:Number(e),isNaN(e))throw new Error("Invalid precision");var l=Number(Number(r)),c=Number(Number(o));if(isNaN(l)||isNaN(c))throw new Error("Invalid grid reference: "+[t,i]);if(0===e)return s(l,6)+","+s(c,6);var d=Math.floor(l/1e5),u=Math.floor(c/1e5);if(d<0||d>6||u<0||u>12)return"";var h=19-u-(19-u)%5+Math.floor((d+10)/5),f=5*(19-u)%25+d%5;h>7&&h++,f>7&&f++;var p=String.fromCharCode(h+"A".charCodeAt(0),f+"A".charCodeAt(0));return l=Math.floor(l%1e5/Math.pow(10,5-e/2)),c=Math.floor(c%1e5/Math.pow(10,5-e/2)),p+" "+s(l,e/2)+" "+s(c,e/2)},osgbToLngLat:function(t,i){return a.inverse([t,i])},gridRefToOsgb:function(t){t=String(t).trim(),this._determineGridRefType(t);var i=t.match(/^(\d+),\s*(\d+)$/);if(i)return new OsGridRef(i[1],i[2]);if(!(i=t.match(/^[A-Z]{2}\s*[0-9]+\s*[0-9]+$/i)))throw new Error("Invalid grid reference: "+t);var e=t.toUpperCase().charCodeAt(0)-"A".charCodeAt(0),n=t.toUpperCase().charCodeAt(1)-"A".charCodeAt(0);e>7&&e--,n>7&&n--;var a=(e-2)%5*5+n%5,s=19-5*Math.floor(e/5)-Math.floor(n/5),r=t.slice(2).trim().split(/\s+/);if(1==r.length&&(r=[r[0].slice(0,r[0].length/2),r[0].slice(r[0].length/2)]),a>=15&&(a-=25),s>20&&(s-=25),a<-10||s<-5)throw new Error("Invalid grid reference: gridref="+t+", e100km="+a+", n100km="+s);if(2!=r.length)throw new Error("Invalid grid reference: "+t);if(r[0].length!=r[1].length)throw new Error("Invalid grid reference: "+t);return r[0]=(r[0]+"00000").slice(0,5),r[1]=(r[1]+"00000").slice(0,5),[parseInt(a+"00000")+parseInt(r[0]),parseInt(s+"00000")+parseInt(r[1])]},gridRefToLngLat:function(t){var i=this.gridRefToOsgb(t);return a.inverse(i)},_determineGridRefType:function(t){if(/^\w\s*\d{3,}\s*\d{3,}$/.test(t))throw new Error("Irish grid references currently unsupported: "+t)}}},mifp:function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return r}));var n=e("EVdn"),a=e.n(n),s=e("jvQH");function r(t){return a.a.extend({},Object(s.default)(t),{dataToLoad:"data_all.json"})}},"nEK/":function(t,i,e){"use strict";i.a=e.p+"ad2f9c148c8f35cb2996a55ceb6e3bbe.png"},o4tf:function(t,i,e){"use strict";var n=e("WvvZ"),a=n.a.extend({initialize:function(t,i,e,a){n.a.prototype.initialize.call(this,t,i,e,a),this._markerList=null,this._bundleConfig=i},fetchData:function(t){return this._doFetchData(t).done(function(t){this.addMarkers(t)}.bind(this))},addMarkers:function(t){for(var i=t.data,e=0;e<i.length;e++)this.parse(i[e]);null!=this._bundleConfig.attribution?this._attributionText=this._bundleConfig.attribution:this._attributionText=t.attribution},addMarker:function(t,i,e,n,a,s,r,o,l){var c={id:t=encodeURIComponent(t),latLng:[parseFloat(i),parseFloat(e)],name:a,extraTexts:s,exportName:a,url:n,icon:r,layerId:l,visited:-1!=this.getVisits().indexOf(t)};if(this._config.dimensional_layering||null==o||0===o.length){if(null==this._markerList&&(this._markerList={}),this._withinConstraints(c)){for(var d=this._markerList,u=0;u<o.length-1;u++){var h=o[u];null==d[h]&&(d[h]={}),d=d[h]}var f=o[o.length-1];null==d[f]&&(d[f]=[]),d[f].push(c)}}else null==this._markerList&&(this._markerList=[]),this._markerList.push(c)},_withinConstraints:function(t){var i=this._manager.getViewConstraints();return null==i||i(t.latLng)},buildImageLinks:function(t){return t.map((function(t,i){return["Image "+(i+1),t]}))},split:function(t,i){return t.split(";").map((function(t){var e=i[t];return null!=e?e:t}))},getMarkerList:function(){return this._markerList},getAttribution:function(){return this._attributionText}});i.a=a},r6U7:function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return r}));var n=e("EVdn"),a=e.n(n),s=e("jvQH");function r(t){return a.a.extend({},Object(s.default)(t),{dataToLoad:"data_mini.json"})}},tVao:function(t,i,e){"use strict";e.r(i);var n=e("Ts1V").a.extend({parse:function(t){var i=t.properties.name,e=this.getBundleConfig().urls[i],n={type:"FeatureCollection",features:[t]},a=[["Length (miles)",t.properties.length],["Notes",t.properties.notes]],s=t.properties.openedDate;if(null!=s){var r=new Date(s).toLocaleDateString();a.push(["Opened",r])}return{name:i,url:e,geojson:n,extraInfos:a}}}),a={};["Pennine Way","Cleveland Way","Offa's Dyke Path","South Downs Way","The Ridgeway","South West Coast Path","Yorkshire Wolds Way","North Downs Way","Peddar's Way and Norfolk Coast Path","Thames Path","Hadrian's Wall Path","Cotswold Way","Pennine Bridleway","England Coast Path","Glyndŵr's Way"].forEach((function(t){var i=t.replace(/^The /g,"").replace(/\s/g,"-").replace(/'/g,"").replace(/ŵ/g,"w").toLowerCase();a[t]="http://www.nationaltrail.co.uk/"+i})),a["Wales Coast Path"]="http://www.walescoastpath.gov.uk";i.default={aspectLabel:"National Trails",dimensionNames:["National Trails"],dataToLoad:"data.geojson",parser:n,attribution:'Natural England Open Data (<a href="http://www.nationalarchives.gov.uk/doc/open-government-licence/version/">OGL</a>)',urls:a}},tbak:function(t,i,e){"use strict";e("bMVF"),e("Has+"),e("bhAg"),e("HYQ+"),e("OsGc"),e("gkNi"),e("UEl+"),e("PMnc"),e("b4G2"),e("BSSW"),e("5fbX"),e("J9yo")},ttLr:function(t,i,e){"use strict";e.r(i),e.d(i,"default",(function(){return r}));var n=e("EVdn"),a=e.n(n),s=e("LEIh");function r(t){return a.a.extend({},Object(s.default)(t),{dataToLoad:"data_all.json"})}}}]);
//# sourceMappingURL=integration~main~mini.3f2be728d72d9b934e74.js.map